#---- Prepare a non-routable domain for directory  synchronization -----# 
$orgName="emceuc1" 
$Domainname=(Get-ADDomain).DNSroot 
Get-ADForest | Format-List UPNSuffixes 
Get-ADForest | Set-ADForest -UPNSuffixes @{add="$orgName.onMicrosoft.com"} 


#---- Change UPN suffix for AAD O365 -----# 
$O365Users= Get-ADUser -Filter * -SearchBase "OU=O365,$ou" 
$O365Users | foreach {$newUpn = $_.UserPrincipalName.Replace("@$Domainname","@$orgName.onMicrosoft.com"); $_ | Set-ADUser -UserPrincipalName $newUpn} 

